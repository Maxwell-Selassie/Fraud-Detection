07:32:16 - INFO : Data has successfully been loaded
07:32:16 - INFO : Number of observations 2512
07:32:16 - INFO : Number of features : 16

07:32:16 - INFO : 
                          count unique                  top  freq         mean          std     min      25%      50%       75%       max
TransactionID              2512   2512             TX000001     1          NaN          NaN     NaN      NaN      NaN       NaN       NaN
AccountID                  2512    495              AC00460    12          NaN          NaN     NaN      NaN      NaN       NaN       NaN
TransactionAmount        2512.0    NaN                  NaN   NaN   297.593778   291.946243    0.26   81.885   211.14  414.5275   1919.11
TransactionDate            2512   2512  2023-04-11 16:29:14     1          NaN          NaN     NaN      NaN      NaN       NaN       NaN
TransactionType            2512      2                Debit  1944          NaN          NaN     NaN      NaN      NaN       NaN       NaN
Location                   2512     43           Fort Worth    70          NaN          NaN     NaN      NaN      NaN       NaN       NaN
DeviceID                   2512    681              D000548     9          NaN          NaN     NaN      NaN      NaN       NaN       NaN
IP Address                 2512    592       200.136.146.93    13          NaN          NaN     NaN      NaN      NaN       NaN       NaN
MerchantID                 2512    100                 M026    45          NaN          NaN     NaN      NaN      NaN       NaN       NaN
Channel                    2512      3               Branch   868          NaN          NaN     NaN      NaN      NaN       NaN       NaN
CustomerAge              2512.0    NaN                  NaN   NaN    44.673965    17.792198    18.0     27.0     45.0      59.0      80.0
CustomerOccupation         2512      4              Student   657          NaN          NaN     NaN      NaN      NaN       NaN       NaN
TransactionDuration      2512.0    NaN                  NaN   NaN   119.643312    69.963757    10.0     63.0    112.5     161.0     300.0
LoginAttempts            2512.0    NaN                  NaN   NaN     1.124602     0.602662     1.0      1.0      1.0       1.0       5.0
AccountBalance           2512.0    NaN                  NaN   NaN  5114.302966  3900.942499  101.25  1504.37  4735.51   7678.82  14977.99
PreviousTransactionDate    2512    360  2024-11-04 08:09:17    16          NaN          NaN     NaN      NaN      NaN       NaN       NaN
07:32:16 - INFO : | Number of numeric columns : 5 | Examples : ['TransactionAmount', 'CustomerAge', 'TransactionDuration']

07:32:16 - INFO : 1 TransactionAmount        | Min : 0.26            | Max : 1919.11   

07:32:16 - INFO : 2 CustomerAge              | Min : 18              | Max : 80        

07:32:16 - INFO : 3 TransactionDuration      | Min : 10              | Max : 300       

07:32:16 - INFO : 4 LoginAttempts            | Min : 1               | Max : 5         

07:32:16 - INFO : 5 AccountBalance           | Min : 101.25          | Max : 14977.99  

07:32:16 - INFO : | Number of categorical columns : 11 | Examples : ['TransactionID', 'AccountID', 'TransactionDate']

07:32:16 - INFO : 1 . TransactionID             |Unique : 2512    | Examples : ['TX000001' 'TX000002' 'TX000003']

07:32:16 - INFO : 2 . AccountID                 |Unique : 495     | Examples : ['AC00128' 'AC00455' 'AC00019']

07:32:16 - INFO : 3 . TransactionDate           |Unique : 2512    | Examples : ['2023-04-11 16:29:14' '2023-06-27 16:44:19' '2023-07-10 18:16:08']

07:32:16 - INFO : 4 . TransactionType           |Unique : 2       | Examples : ['Debit' 'Credit']

07:32:16 - INFO : 5 . Location                  |Unique : 43      | Examples : ['San Diego' 'Houston' 'Mesa']

07:32:16 - INFO : 6 . DeviceID                  |Unique : 681     | Examples : ['D000380' 'D000051' 'D000235']

07:32:16 - INFO : 7 . IP Address                |Unique : 592     | Examples : ['162.198.218.92' '13.149.61.4' '215.97.143.157']

07:32:16 - INFO : 8 . MerchantID                |Unique : 100     | Examples : ['M015' 'M052' 'M009']

07:32:16 - INFO : 9 . Channel                   |Unique : 3       | Examples : ['ATM' 'Online' 'Branch']

07:32:16 - INFO : 10. CustomerOccupation        |Unique : 4       | Examples : ['Doctor' 'Student' 'Retired']

07:32:16 - INFO : 11. PreviousTransactionDate   |Unique : 360     | Examples : ['2024-11-04 08:08:08' '2024-11-04 08:09:35' '2024-11-04 08:07:04']

07:32:16 - INFO : Number of duplicates : 0

07:32:16 - INFO : No duplicates found in the data

07:32:16 - INFO : Empty DataFrame
Columns: [missing_data, missing_pct]
Index: []
07:32:16 - INFO : 0. TransactionAmount    | Number of outliers : 113  | Range : (-417.07875000000007 - 913.49125)
07:32:16 - INFO : 1. CustomerAge          | Number of outliers : 0    | Range : (-21.0 - 107.0)
07:32:16 - INFO : 2. TransactionDuration  | Number of outliers : 0    | Range : (-84.0 - 308.0)
07:32:16 - INFO : 3. LoginAttempts        | Number of outliers : 122  | Range : (1.0 - 1.0)
07:32:16 - INFO : 4. AccountBalance       | Number of outliers : 0    | Range : (-7757.304999999999 - 16940.495)
07:32:16 - INFO : DataFrame has been loaded successfully!
07:32:16 - INFO : Starting feature engineering...
07:32:16 - INFO : Feature engineering completed: 34 columns total.
07:32:17 - INFO : Feature names successfully saved..
07:32:17 - INFO : Starting feature scaling and encoding...
07:32:17 - INFO : Feature scaling and encoding completed
07:33:34 - INFO : Dataset successfully loaded from data/processed_bank_transaction_data.csv
07:33:34 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
07:40:04 - INFO : Dataset successfully loaded from data/processed_bank_transaction_data.csv
07:40:04 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
07:40:42 - INFO : Dataset successfully loaded from data/processed_bank_transaction_data.csv
07:40:42 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
07:40:44 - INFO : Anomalies detected: 76, out of 2512
07:40:44 - INFO : 
    AccountID  TransactionAmount TransactionType     Location DeviceID  ... avg_loginAttempts loginAttemps_excess TransactionAmount_log  AnomalyFlag AnomalyScore
6     AC00199               7.08          Credit      Seattle  D000241  ...          1.000000            0.000000              2.089392            1     0.013508
85    AC00098            1340.19          Credit       Austin  D000574  ...          1.000000            0.000000              7.201313            1     0.014703
101   AC00018              98.54          Credit      El Paso  D000528  ...          2.333333           -1.333333              4.600560            1     0.017546
147   AC00161             514.95           Debit     New York  D000109  ...          2.000000            3.000000              6.246010            1     0.016954
176   AC00363            1362.55           Debit      El Paso  D000213  ...          1.000000            0.000000              7.217847            1     0.053738
195   AC00363               3.30          Credit  Los Angeles  D000215  ...          1.000000            0.000000              1.458615            1     0.001197
274   AC00454            1176.28          Credit  Kansas City  D000476  ...          2.000000            3.000000              7.070962            1     0.071646
340   AC00107            1830.00           Debit  San Antonio  D000436  ...          1.000000            0.000000              7.512618            1     0.025515
375   AC00316            1392.54           Debit      El Paso  D000113  ...          1.500000           -0.500000              7.239603            1     0.025907
394   AC00326               6.30           Debit     Columbus  D000539  ...          1.800000            3.200000              1.987874            1     0.025118

[10 rows x 36 columns]
07:40:45 - INFO : Isolation Forest model saved successfully.
07:40:45 - INFO : Training RandomForest...(This May Take A While)
07:41:38 - INFO : Training XGBoost...(This May Take A While)
07:41:52 - INFO : Best model 'Xgboost' saved as 'Xgboost_fraud_detector.pkl
08:39:03 - INFO : Dataset successfully loaded from data/processed_bank_transaction_data.csv
08:39:03 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
08:39:05 - INFO : Anomalies detected: 76, out of 2512
08:39:06 - INFO : 
    AccountID  TransactionAmount TransactionType     Location DeviceID  ... avg_loginAttempts loginAttemps_excess TransactionAmount_log  AnomalyFlag AnomalyScore
6     AC00199               7.08          Credit      Seattle  D000241  ...          1.000000            0.000000              2.089392            1     0.013508
85    AC00098            1340.19          Credit       Austin  D000574  ...          1.000000            0.000000              7.201313            1     0.014703
101   AC00018              98.54          Credit      El Paso  D000528  ...          2.333333           -1.333333              4.600560            1     0.017546
147   AC00161             514.95           Debit     New York  D000109  ...          2.000000            3.000000              6.246010            1     0.016954
176   AC00363            1362.55           Debit      El Paso  D000213  ...          1.000000            0.000000              7.217847            1     0.053738
195   AC00363               3.30          Credit  Los Angeles  D000215  ...          1.000000            0.000000              1.458615            1     0.001197
274   AC00454            1176.28          Credit  Kansas City  D000476  ...          2.000000            3.000000              7.070962            1     0.071646
340   AC00107            1830.00           Debit  San Antonio  D000436  ...          1.000000            0.000000              7.512618            1     0.025515
375   AC00316            1392.54           Debit      El Paso  D000113  ...          1.500000           -0.500000              7.239603            1     0.025907
394   AC00326               6.30           Debit     Columbus  D000539  ...          1.800000            3.200000              1.987874            1     0.025118

[10 rows x 36 columns]
08:39:06 - INFO : Isolation Forest model saved successfully.
08:39:38 - INFO : Dataset successfully loaded from data/processed_bank_transaction_data.csv
08:39:38 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
08:39:40 - INFO : Anomalies detected: 76, out of 2512
08:39:40 - INFO : 
    AccountID  TransactionAmount TransactionType     Location DeviceID  ... avg_loginAttempts loginAttemps_excess TransactionAmount_log  AnomalyFlag AnomalyScore
6     AC00199               7.08          Credit      Seattle  D000241  ...          1.000000            0.000000              2.089392            1     0.013508
85    AC00098            1340.19          Credit       Austin  D000574  ...          1.000000            0.000000              7.201313            1     0.014703
101   AC00018              98.54          Credit      El Paso  D000528  ...          2.333333           -1.333333              4.600560            1     0.017546
147   AC00161             514.95           Debit     New York  D000109  ...          2.000000            3.000000              6.246010            1     0.016954
176   AC00363            1362.55           Debit      El Paso  D000213  ...          1.000000            0.000000              7.217847            1     0.053738
195   AC00363               3.30          Credit  Los Angeles  D000215  ...          1.000000            0.000000              1.458615            1     0.001197
274   AC00454            1176.28          Credit  Kansas City  D000476  ...          2.000000            3.000000              7.070962            1     0.071646
340   AC00107            1830.00           Debit  San Antonio  D000436  ...          1.000000            0.000000              7.512618            1     0.025515
375   AC00316            1392.54           Debit      El Paso  D000113  ...          1.500000           -0.500000              7.239603            1     0.025907
394   AC00326               6.30           Debit     Columbus  D000539  ...          1.800000            3.200000              1.987874            1     0.025118

[10 rows x 36 columns]
08:39:41 - INFO : Isolation Forest model saved successfully.
08:42:03 - INFO : Dataset successfully loaded from data/processed_bank_transaction_data.csv
08:42:03 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
08:42:05 - INFO : Anomalies detected: 76, out of 2512
08:42:06 - INFO : 
    AccountID  TransactionAmount TransactionType     Location DeviceID  ... avg_loginAttempts loginAttemps_excess TransactionAmount_log  AnomalyFlag AnomalyScore
6     AC00199               7.08          Credit      Seattle  D000241  ...          1.000000            0.000000              2.089392            1     0.013508
85    AC00098            1340.19          Credit       Austin  D000574  ...          1.000000            0.000000              7.201313            1     0.014703
101   AC00018              98.54          Credit      El Paso  D000528  ...          2.333333           -1.333333              4.600560            1     0.017546
147   AC00161             514.95           Debit     New York  D000109  ...          2.000000            3.000000              6.246010            1     0.016954
176   AC00363            1362.55           Debit      El Paso  D000213  ...          1.000000            0.000000              7.217847            1     0.053738
195   AC00363               3.30          Credit  Los Angeles  D000215  ...          1.000000            0.000000              1.458615            1     0.001197
274   AC00454            1176.28          Credit  Kansas City  D000476  ...          2.000000            3.000000              7.070962            1     0.071646
340   AC00107            1830.00           Debit  San Antonio  D000436  ...          1.000000            0.000000              7.512618            1     0.025515
375   AC00316            1392.54           Debit      El Paso  D000113  ...          1.500000           -0.500000              7.239603            1     0.025907
394   AC00326               6.30           Debit     Columbus  D000539  ...          1.800000            3.200000              1.987874            1     0.025118

[10 rows x 36 columns]
08:42:06 - INFO : Isolation Forest model saved successfully.
08:42:06 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
08:42:06 - INFO : Training RandomForest...(This May Take A While)
08:42:46 - INFO : Training XGBoost...(This May Take A While)
08:44:42 - INFO : Dataset successfully loaded from data/processed_bank_transaction_data.csv
08:44:42 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
08:44:44 - INFO : Anomalies detected: 76, out of 2512
08:44:44 - INFO : 
    AccountID  TransactionAmount TransactionType     Location DeviceID  ... avg_loginAttempts loginAttemps_excess TransactionAmount_log  AnomalyFlag AnomalyScore
6     AC00199               7.08          Credit      Seattle  D000241  ...          1.000000            0.000000              2.089392            1     0.013508
85    AC00098            1340.19          Credit       Austin  D000574  ...          1.000000            0.000000              7.201313            1     0.014703
101   AC00018              98.54          Credit      El Paso  D000528  ...          2.333333           -1.333333              4.600560            1     0.017546
147   AC00161             514.95           Debit     New York  D000109  ...          2.000000            3.000000              6.246010            1     0.016954
176   AC00363            1362.55           Debit      El Paso  D000213  ...          1.000000            0.000000              7.217847            1     0.053738
195   AC00363               3.30          Credit  Los Angeles  D000215  ...          1.000000            0.000000              1.458615            1     0.001197
274   AC00454            1176.28          Credit  Kansas City  D000476  ...          2.000000            3.000000              7.070962            1     0.071646
340   AC00107            1830.00           Debit  San Antonio  D000436  ...          1.000000            0.000000              7.512618            1     0.025515
375   AC00316            1392.54           Debit      El Paso  D000113  ...          1.500000           -0.500000              7.239603            1     0.025907
394   AC00326               6.30           Debit     Columbus  D000539  ...          1.800000            3.200000              1.987874            1     0.025118

[10 rows x 36 columns]
08:44:45 - INFO : Isolation Forest model saved successfully.
08:44:45 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
08:44:45 - INFO : Training RandomForest...(This May Take A While)
08:45:25 - INFO : Training XGBoost...(This May Take A While)
08:45:35 - INFO : Best model 'RandomForest' saved as 'RandomForest_fraud_detector.pkl
08:52:23 - INFO : Dataset successfully loaded from data/processed_bank_transaction_data.csv
08:52:23 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
08:53:07 - INFO : Dataset successfully loaded from data/processed_bank_transaction_data.csv
08:53:07 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
08:53:37 - INFO : Dataset successfully loaded from data/processed_bank_transaction_data.csv
08:53:37 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
08:53:40 - INFO : Anomalies detected: 76, out of 2512
08:53:40 - INFO : 
    AccountID  TransactionAmount TransactionType     Location DeviceID  ... avg_loginAttempts loginAttemps_excess TransactionAmount_log  AnomalyFlag AnomalyScore
6     AC00199               7.08          Credit      Seattle  D000241  ...          1.000000            0.000000              2.089392            1     0.013508
85    AC00098            1340.19          Credit       Austin  D000574  ...          1.000000            0.000000              7.201313            1     0.014703
101   AC00018              98.54          Credit      El Paso  D000528  ...          2.333333           -1.333333              4.600560            1     0.017546
147   AC00161             514.95           Debit     New York  D000109  ...          2.000000            3.000000              6.246010            1     0.016954
176   AC00363            1362.55           Debit      El Paso  D000213  ...          1.000000            0.000000              7.217847            1     0.053738
195   AC00363               3.30          Credit  Los Angeles  D000215  ...          1.000000            0.000000              1.458615            1     0.001197
274   AC00454            1176.28          Credit  Kansas City  D000476  ...          2.000000            3.000000              7.070962            1     0.071646
340   AC00107            1830.00           Debit  San Antonio  D000436  ...          1.000000            0.000000              7.512618            1     0.025515
375   AC00316            1392.54           Debit      El Paso  D000113  ...          1.500000           -0.500000              7.239603            1     0.025907
394   AC00326               6.30           Debit     Columbus  D000539  ...          1.800000            3.200000              1.987874            1     0.025118

[10 rows x 36 columns]
08:53:41 - INFO : Isolation Forest model saved successfully.
08:53:41 - INFO : Preprocessor successfully loaded from artifacts/preprocessor.joblib
08:53:41 - INFO : Training RandomForest...(This May Take A While)
08:54:28 - INFO : Training XGBoost...(This May Take A While)
08:54:39 - INFO : Best model 'RandomForest' saved as 'RandomForest_fraud_detector.pkl
09:11:43 - INFO : Starting batch inference process: 
09:11:43 - ERROR : Failed to load batch file : [Errno 2] No such file or directory: 'data\\new_batch.csv'
09:16:29 - INFO : Starting batch inference process: 
09:16:29 - ERROR : Failed to load batch file : [Errno 2] No such file or directory: 'data/new_batch.csv'
09:17:20 - INFO : Starting batch inference process: 
09:17:20 - INFO : New batch loaded with shape: (503, 36)
09:17:20 - INFO : Starting feature engineering...
09:19:13 - INFO : Starting batch inference process: 
09:19:13 - INFO : New batch loaded with shape: (2512, 16)
09:19:13 - INFO : Starting feature engineering...
09:19:13 - INFO : Feature engineering completed: 34 columns total.
09:19:13 - INFO : Feature names successfully saved..
09:19:13 - INFO : Feature Engineering completed
09:19:13 - INFO : Preprocessor successfully loaded!
09:19:13 - INFO : Feature Encoding completed
09:19:13 - ERROR : Model not found! Check file path and try again!
Traceback (most recent call last):
  File "C:\Users\Maxwe\OneDrive\Documents\Clustering and Anomaly Detection\Fraud-Detection\src\batch_inference.py", line 31, in load_iso_forest
    iso_forest_model = joblib.load(filename)
                       ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Maxwe\AppData\Local\pypoetry\Cache\virtualenvs\fraud-detection-r6Xl52aS-py3.11\Lib\site-packages\joblib\numpy_pickle.py", line 735, in load
    with open(filename, "rb") as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'artifact/isolation_forest_model.joblib'
09:20:12 - INFO : Starting batch inference process: 
09:20:12 - INFO : New batch loaded with shape: (2512, 16)
09:20:12 - INFO : Starting feature engineering...
09:20:12 - INFO : Feature engineering completed: 34 columns total.
09:20:13 - INFO : Feature names successfully saved..
09:20:13 - INFO : Feature Engineering completed
09:20:13 - INFO : Preprocessor successfully loaded!
09:20:13 - INFO : Feature Encoding completed
09:20:13 - INFO : Isolation Forest Model successfully loaded!
09:20:13 - INFO : IsolationForest Anomalies detected: 76 out of 2512
09:20:47 - INFO : Starting batch inference process: 
09:20:47 - INFO : New batch loaded with shape: (2512, 16)
09:20:47 - INFO : Starting feature engineering...
09:20:48 - INFO : Feature engineering completed: 34 columns total.
09:20:48 - INFO : Feature names successfully saved..
09:20:48 - INFO : Feature Engineering completed
09:20:48 - INFO : Preprocessor successfully loaded!
09:20:48 - INFO : Feature Encoding completed
09:20:48 - INFO : Isolation Forest Model successfully loaded!
09:20:48 - INFO : IsolationForest Anomalies detected: 76 out of 2512
09:20:49 - INFO : rfoost Model successfully loaded!
